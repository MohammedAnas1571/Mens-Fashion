<%- include("../partials/admin/header") %>

<div class="main-panel">
    <div class="content-wrapper">
        <div class="page-header">
            <h3 class="page-title">Product Details</h3>
        </div>
        <div class="row">
            <div class="col-md-12 grid-margin stretch-card">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title">Product Information</h4>
                        <div class="mb-3"> <a href="/admin/productlist ">Product Details</a>
                        </div>
                        <form action="/admin/addproduct" method="post" class="forms-sample" enctype="multipart/form-data">
                            <% if (message !== "") { %>
                            <p class="text-danger"><%= message %></p>
                            <% } %>

                            <!-- Product Name -->
                            <div class="form-group">
                                <label for="productName">Product Name</label>
                                <input type="text" class="form-control text-black" name="productName" id="productName" placeholder="Name">
                            </div>

                            <!-- Brand Name -->
                            <div class="form-group">
                                <label for="brandName">Brand Name</label>
                                <input type="text" class="form-control text-black" name="brandName" id="brandName" placeholder="Brand Name">
                            </div>

                            <!-- Price -->
                            <div class="form-group">
                                <label for="price">Price</label>
                                <input type="number" class="form-control text-black" name="price" id="price" placeholder="Price">
                            </div>

                            <div class="form-group">
                                <label for="productName">Offer %</label>
                                <input type="text" class="form-control text-black" name="offer" id="productName" placeholder="OfferPrice %">
                            </div>

                            <!-- Stock Count -->
                            <div class="form-group">
                                <label for="stockCount">Stock </label>
                                <input type="number" class="form-control text-black" name="stock" id="stockCount" placeholder="Count">
                            </div>

                            <!-- Description -->
                            <div class="form-group">
                                <label for="description">Description</label>
                                <textarea class="text-black form-control" id="description" name="description" rows="8" placeholder="Write about the Product"></textarea>
                            </div>

                            <!-- Product Categories and Tags -->
                            <div class="col-md-12 grid-margin stretch-card">
                                <div class="card">
                                    <div class="card-body">
                                        <h4 class="card-title">Product Categories and Tags</h4>
                                        <div class="form-group">
                                            <label for="category">Category</label>
                                            <select class="form-control form-control-lg text-black" name="category" id="category">
                                                <% Categories.forEach(category => { %>
                                                <option><%= category.categoryName %></option>
                                                <% }) %>
                                            </select>
                                        </div>

                                        <!-- Images Upload -->
                                        <div class="form-group">
                                            <label>Images Upload (Required: 3)</label>
                                            <div class="input-group col-md-12">
                                                <input type="file" id="images" multiple name="images" class="form-control file-upload-info" required>
                                            </div>
                                            <div id="image-preview-container" class="mt-3"></div>
                                        </div>

                                        <!-- Color -->
                                        <div class="form-group">
                                            <label for="color">Color</label>
                                            <select class="form-control text-black" name="color" id="color">
                                                <option value="-1" disabled>Select</option>
                                                <option>White</option>
                                                <option>Black</option>
                                                <option>Blue</option>
                                                <option>Silver</option>
                                                <option>Gold</option>
                                                <option>Red</option>
                                                <option>Gray</option>
                                                <option>Yellow</option>
                                                <option>Pink</option>
                                            </select>
                                        </div>

                                        <!-- Submit Button -->
                                        <button type="submit" class="btn btn-primary mb-2">Submit</button>
                                    </div>
                                </div>
                            </div>
                        </form>
                        <script>
                            function handleImagePreview(input) {
                                const container = document.getElementById('image-preview-container');
                                container.innerHTML = ''; // Clear previous previews

                                if (input.files) {
                                    Array.from(input.files).forEach((file, index) => {
                                        const reader = new FileReader();

                                        reader.onload = function (e) {
                                            const preview = document.createElement('div');
                                            preview.className = 'image-preview';

                                            const image = document.createElement('img');
                                            image.src = e.target.result;
                                            image.className = 'img-thumbnail';
                                            preview.appendChild(image);

                                            // Add remove emblem
                                            const removeEmblem = document.createElement('span');
                                            removeEmblem.innerHTML = '&times;';
                                            removeEmblem.className = 'remove-emblem';
                                            removeEmblem.onclick = function () {
                                                container.removeChild(preview);
                                                input.value = ''; // Clear the corresponding file in the input
                                            };
                                            preview.appendChild(removeEmblem);

                                            container.appendChild(preview);
                                        };

                                        reader.readAsDataURL(file);
                                    });
                                }
                            }

                            document.getElementById('images').addEventListener('change', function () {
                                handleImagePreview(this);
                            });
                        </script>

                        <style>
                            .image-preview {
                                display: inline-block;
                                margin-right: 10px;
                                width: 100px; /* Set the desired width */
                                height: 100px; /* Set the desired height */
                                position: relative;
                            }

                            .remove-emblem {
                                position: absolute;
                                top: 5px;
                                right: 5px;
                                color: red;
                                cursor: pointer;
                                font-size: 18px;
                                font-weight: bold;
                                background-color: white;
                                border-radius: 50%;
                                padding: 2px 5px;
                            }
                        </style>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
